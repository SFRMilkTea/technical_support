{% extends 'base.html' %}

{% block title %}Сотрудники{% endblock %}

{% block content %}

<h1>Пользователи</h1>
{% if messages %}
<div class="messages-container">
    {% for message in messages %}
    <div class="message-box {% if message.tags %}{{ message.tags }}{% endif %}">
        <span>{{ message }}</span>
        <button class="close-button" onclick="this.parentElement.style.display='none';">&times;</button>
    </div>
    {% endfor %}
</div>
{% endif %}
<script>
     function showForm() {
        var form = document.getElementById("addUserForm");
        if (form.style.display === "none" || form.style.display === "") {
            form.style.display = "block";
        } else {
            form.style.display = "none";
        }
    }


</script>

<!-- Форма для добавления пользователя (скрыта по умолчанию) -->
<div id="addUserForm" class="form-container">
    <h2>Добавить пользователя</h2>
    <form method="POST">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Сохранить</button>
        <button type="button" class="cancel-button" onclick="showForm()">Отмена</button>
    </form>
</div>
<table>
    <tr>
        <th>ФИО</th>
        <th>Email</th>
        <th>Отдел</th>
        <th>
            <button class="add-button" onclick="showForm()">+</button>
        </th>
    </tr>
    {% for user in users %}
    <tr>
        <td>{{ user.surename }} {{ user.name }} {{ user.patronymic|default_if_none:'' }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.id_department.name }}</td>
        <td>
            <!-- Кнопка для удаления пользователя -->
            <a href="{% url 'delete_user' user.id %}" class="delete-button"
               onclick="return confirm('Вы уверены, что хотите удалить этого пользователя?');">
                Удалить
            </a>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}